# ================================================================================
# CONFIGURAZIONE PIPELINE SPECIALIZZATA LEGAL-NER - VERSIONE ESPANSA
# ================================================================================
# Questo file controlla TUTTI i parametri della pipeline di estrazione fonti normative.
# Ogni modifica a questo file viene applicata immediatamente senza ricompilazione.
# ================================================================================

# ===================================
# SEZIONE 1: MODELLI AI
# ===================================
models:
  entity_detector:
    # Using DeepMount00/Italian_NER_XXL_v2 as primary NER model
    primary: "DeepMount00/Italian_NER_XXL_v2"
    fallback: "Babelscape/wikineural-multilingual-ner"
    max_length: 256

  legal_classifier:
    primary: "dlicari/distil-ita-legal-bert"
    embedding_max_length: 256

  semantic_correlator:
    model: "dlicari/Italian-Legal-BERT"

# ===================================
# SEZIONE 2: SOGLIE DI CONFIDENCE
# ===================================
confidence_thresholds:
  # Stage 1: Entity Detection
  minimum_detection_confidence: 0.5

  # Stage 2: Legal Classification
  rule_based_priority_threshold: 0.8
  semantic_boost_factor: 0.1
  semantic_similarity_scale: 0.95
  minimum_classification_confidence: 0.7
  enable_semantic_validation_always: true
  semantic_discrepancy_confidence_threshold: 0.90

  # Confidence specifiche per pattern rule-based
  rule_based_confidence:
    # Codici specifici (massima affidabilità)
    specific_codes: 0.99
    codice_crisi_impresa: 0.95
    codice_beni_culturali: 0.99
    codice_crisi_insolvenza: 0.95
    codice_navigazione: 0.95
    codice_strada: 0.95
    codice_consumo: 0.95
    codice_ambiente: 0.95
    codice_turismo: 0.95
    codice_appalti: 0.95
    codice_processo_amministrativo: 0.95
    generic_codes: 0.85
    
    # Testi Unici - Alta affidabilità
    testo_unico: 0.95
    tub: 0.95  # Testo Unico Bancario
    tuf: 0.95  # Testo Unico della finanza
    tulps: 0.95  # Testo Unico Leggi di Pubblica Sicurezza
    tuel: 0.95  # Testo Unico Enti Locali
    tuir: 0.95  # Testo Unico Imposte sui Redditi
    tusl: 0.95  # Testo Unico Sicurezza Lavoro
    tupi: 0.95  # Testo Unico Pubblico Impiego
    tubc: 0.95  # Testo Unico Beni Culturali e Paesaggio
    tuog: 0.95  # Testo Unico Ordinamento Giudiziario

    # Codici fondamentali - abbreviazioni
    codice_civile_abbrev: 0.99
    codice_civile_full: 0.90
    codice_penale_abbrev: 0.99
    codice_penale_full: 0.90
    codice_procedura_civile_abbrev: 0.99
    codice_procedura_civile_full: 0.90
    codice_procedura_penale_abbrev: 0.99
    codice_procedura_penale_full: 0.90

    # Decreti Legislativi
    decreto_legislativo_full: 0.98
    decreto_legislativo_abbrev: 0.95

    # Decreti Presidenziali
    dpr_full: 0.98
    dpr_abbrev: 0.95
    
    # Decreti del Presidente del Consiglio
    dpcm_full: 0.95
    dpcm_abbrev: 0.92

    # Decreti Ministeriali
    decreto_ministeriale_full: 0.92
    decreto_ministeriale_abbrev: 0.88

    # Decreti Legge
    decreto_legge_full: 0.95
    decreto_legge_abbrev: 0.92

    # Leggi
    legge_full: 0.90
    legge_abbrev: 0.75
    legge_fallimentare_full: 0.95
    legge_fallimentare_abbrev: 0.90
    legge_costituzionale_full: 0.98
    legge_costituzionale_abbrev: 0.95
    legge_regionale_full: 0.88
    legge_regionale_abbrev: 0.85
    legge_provinciale_full: 0.88
    legge_provinciale_abbrev: 0.85

    # Costituzione
    costituzione_full: 0.98
    costituzione_abbrev: 0.90

    # Normativa Internazionale
    convention: 0.95
    trattato: 0.98
    
    # Normativa Europea
    direttiva_ue: 0.98
    regolamento_ue: 0.98
    decisione_ue: 0.95
    raccomandazione_ue: 0.85

    # Istituzioni
    institution: 0.99

    # Pattern Generici
    generic_article: 0.3
    default: 0.5

# ===================================
# SEZIONE 3: FINESTRE DI CONTESTO
# ===================================
context_windows:
  entity_expansion:
    left_window: 150
    right_window: 150
    context_window: 75

  semantic_context:
    immediate_context: 50
    extended_context: 120
    full_context: 250

  classification_context: 200

# ===================================
# SEZIONE 4: MAPPATURA NORMATTIVA ESPANSA
# ===================================
normattiva_mapping:
  decreto_legislativo:
    - "d.lgs."
    - "d.lgs"
    - "dlgs"
    - "d.lg."
    - "d.lg"
    - "decreto legislativo"
    - "decreto.legislativo"

  decreto_legge:
    - "d.l."
    - "d.l"
    - "dl"
    - "decreto legge"
    - "decreto-legge"

  decreto_presidente_repubblica:
    - "d.p.r."
    - "d.p.r"
    - "dpr"
    - "decreto del presidente della repubblica"
    - "decreto presidente repubblica"

  decreto_ministeriale:
    - "d.m."
    - "d.m"
    - "dm"
    - "decreto ministeriale"

  decreto_presidente_consiglio:
    - "d.p.c.m."
    - "d.p.c.m"
    - "dpcm"
    - "decreto del presidente del consiglio dei ministri"
    - "decreto presidente consiglio ministri"

  decreto_dirigenziale:
    - "d.d."
    - "d.d"
    - "dd"
    - "decreto dirigenziale"
    - "determina dirigenziale"
    - "determinazione"

  decreto_assessore_regionale:
    - "d.a.r."
    - "d.a.r"
    - "dar"
    - "decreto assessore regionale"

  decreto_presidente_giunta:
    - "d.p.g.r."
    - "d.p.g.r"
    - "dpgr"
    - "decreto presidente giunta regionale"

  decreto_sindaco_metropolitano:
    - "d.s.m."
    - "d.s.m"
    - "dsm"
    - "decreto sindaco metropolitano"

  delibera_giunta_regionale:
    - "d.g.r."
    - "d.g.r"
    - "dgr"
    - "delibera giunta regionale"

  delibera_consiglio_regionale:
    - "d.c.r."
    - "d.c.r"
    - "dcr"
    - "delibera consiglio regionale"

  delibera_giunta_comunale:
    - "d.g.c."
    - "d.g.c"
    - "dgc"
    - "delibera giunta comunale"

  delibera_consiglio_comunale:
    - "d.c.c."
    - "d.c.c"
    - "dcc"
    - "delibera consiglio comunale"

  delibera_cipe:
    - "d.cipe"
    - "dcipe"
    - "delibera cipe"
    - "delibera comitato interministeriale programmazione economica"

  legge:
    - "l."
    - "l"
    - "legge"

  legge_fallimentare:
    - "L.F."
    - "L.F"
    - "l.f."
    - "l.f"
    - "lf"
    - "r.d. 267/1942"
    - "regio decreto 267/1942"
    - "legge fallimentare"

  legge_costituzionale:
    - "l.cost."
    - "l.cost"
    - "l.c."
    - "l.c"
    - "lc"
    - "legge costituzionale"

  legge_regionale:
    - "l.r."
    - "l.r"
    - "lr"
    - "legge regionale"

  legge_provinciale:
    - "l.p."
    - "l.p"
    - "lp"
    - "legge provinciale"

  regio_decreto:
    - "r.d."
    - "rd"
    - "r.d"
    - "regio decreto"

  # Codici principali
  codice_civile:
    - "c.c."
    - "c.c"
    - "cc"
    - "codice civile"

  codice_penale:
    - "c.p."
    - "c.p"
    - "cp"
    - "codice penale"

  codice_procedura_civile:
    - "c.p.c."
    - "c.p.c"
    - "cpc"
    - "codice di procedura civile"
    - "codice procedura civile"

  codice_procedura_penale:
    - "c.p.p."
    - "c.p.p"
    - "cpp"
    - "codice di procedura penale"
    - "codice procedura penale"

  # Codici speciali
  codice_navigazione:
    - "c.nav."
    - "c.nav"
    - "cnav"
    - "c.n."
    - "cn"
    - "codice della navigazione"
    - "codice navigazione"

  codice_strada:
    - "c.str."
    - "c.str"
    - "cstr"
    - "cds"
    - "c.d.s."
    - "c.d.s"
    - "codice della strada"
    - "codice strada"

  codice_crisi_impresa:
    - "CCII"
    - "ccii"
    - "c.c.i.i."
    - "c.c.i.i"
    - "codice della crisi d'impresa e dell'insolvenza"
    - "codice crisi impresa"
    - "codice crisi insolvenza"

  codice_beni_culturali:
    - "cbc"
    - "c.b.c."
    - "c.b.c"
    - "codice dei beni culturali"
    - "codice beni culturali e del paesaggio"
    - "cbcp"

  codice_consumo:
    - "c.cons."
    - "c.cons"
    - "ccons"
    - "codice del consumo"
    - "codice consumo"

  codice_ambiente:
    - "c.amb."
    - "c.amb"
    - "camb"
    - "codice dell'ambiente"
    - "codice ambiente"

  codice_turismo:
    - "c.tur."
    - "c.tur"
    - "ctur"
    - "codice del turismo"
    - "codice turismo"

  codice_appalti:
    - "c.app."
    - "c.app"
    - "capp"
    - "codice degli appalti"
    - "codice appalti"

  codice_processo_amministrativo:
    - "c.p.a."
    - "c.p.a"
    - "cpa"
    - "codice del processo amministrativo"
    - "codice processo amministrativo"

  # Testi Unici
  testo_unico:
    - "t.u."
    - "tu"
    - "t.u"
    - "testo unico"

  tub:
    - "tub"
    - "t.u.b."
    - "t.u.b"
    - "testo unico bancario"
    - "testo unico delle leggi in materia bancaria"

  tuf:
    - "tuf"
    - "t.u.f."
    - "t.u.f"
    - "testo unico della finanza"
    - "testo unico delle disposizioni in materia di intermediazione finanziaria"

  tulps:
    - "tulps"
    - "t.u.l.p.s."
    - "t.u.l.p.s"
    - "testo unico delle leggi di pubblica sicurezza"

  tuel:
    - "tuel"
    - "t.u.e.l."
    - "t.u.e.l"
    - "testo unico degli enti locali"

  tuir:
    - "tuir"
    - "t.u.i.r."
    - "t.u.i.r"
    - "testo unico delle imposte sui redditi"

  tusl:
    - "tusl"
    - "t.u.s.l."
    - "t.u.s.l"
    - "testo unico sulla sicurezza del lavoro"

  tupi:
    - "tupi"
    - "t.u.p.i."
    - "t.u.p.i"
    - "testo unico del pubblico impiego"

  tubc:
    - "tubc"
    - "t.u.b.c."
    - "t.u.b.c"
    - "testo unico dei beni culturali"

  tuog:
    - "tuog"
    - "t.u.o.g."
    - "t.u.o.g"
    - "testo unico dell'ordinamento giudiziario"

  costituzione:
    - "cost."
    - "cost"
    - "costituzione"
    - "costituzione italiana"
    - "carta costituzionale"

  # Normativa Europea
  regolamento_ue:
    - "reg. ue"
    - "reg.ue"
    - "regue"
    - "regolamento ue"
    - "regolamento (ue)"
    - "reg. ce"
    - "reg.ce"
    - "regce"
    - "regolamento ce"
    - "regolamento (ce)"

  direttiva_ue:
    - "dir. ue"
    - "dir.ue"
    - "dirue"
    - "direttiva ue"
    - "direttiva (ue)"
    - "dir. ce"
    - "dir.ce"
    - "dirce"
    - "direttiva ce"
    - "direttiva (ce)"
    - "dir. cee"
    - "dir.cee"
    - "dircee"
    - "direttiva cee"

  decisione_ue:
    - "dec. ue"
    - "dec.ue"
    - "decisione ue"
    - "decisione (ue)"
    - "dec. ce"
    - "dec.ce"
    - "decisione ce"

  raccomandazione_ue:
    - "racc. ue"
    - "racc.ue"
    - "raccomandazione ue"
    - "raccomandazione (ue)"

  trattato_unione_europea:
    - "tue"
    - "t.u.e."
    - "t.u.e"
    - "trattato sull'unione europea"
    - "tfue"
    - "t.f.u.e."
    - "t.f.u.e"
    - "trattato sul funzionamento dell'unione europea"

  convenzione_europea_diritti:
    - "cedu"
    - "c.e.d.u."
    - "c.e.d.u"
    - "convenzione europea diritti uomo"
    - "convenzione europea per la salvaguardia dei diritti dell'uomo"

  # Istituzioni giudiziarie
  cassazione:
    - "cass."
    - "cass"
    - "cassazione"
    - "suprema corte di cassazione"
    - "s.c."
    - "sc"

  corte_costituzionale:
    - "corte costituzionale"
    - "corte cost."
    - "corte cost"
    - "consulta"

  consiglio_stato:
    - "consiglio di stato"
    - "cons. st."
    - "cons.st"
    - "c.d.s."
    - "c.d.s"
    - "cds"

  tar:
    - "tar"
    - "t.a.r."
    - "t.a.r"
    - "tribunale amministrativo regionale"

  tribunale:
    - "trib."
    - "trib"
    - "tribunale"

  corte_appello:
    - "app."
    - "app"
    - "corte d'appello"
    - "c.app."
    - "c.app"

  pretura:
    - "pret."
    - "pret"
    - "pretura"
    - "pretore"

  giudice_pace:
    - "giud. pace"
    - "g.d.p."
    - "g.d.p"
    - "gdp"
    - "giudice di pace"

  procura_repubblica:
    - "proc. rep."
    - "proc.rep"
    - "p.r."
    - "p.r"
    - "pr"
    - "procura della repubblica"

  # Autorità amministrative indipendenti
  autorita_garante_concorrenza:
    - "agcm"
    - "a.g.c.m."
    - "a.g.c.m"
    - "autorità garante concorrenza mercato"
    - "antitrust"

  autorita_garante_privacy:
    - "garante privacy"
    - "autorità garante protezione dati personali"
    - "gpdp"

  autorita_garante_comunicazioni:
    - "agcom"
    - "a.g.com"
    - "autorità garante comunicazioni"

  anac:
    - "anac"
    - "a.n.a.c."
    - "a.n.a.c"
    - "autorità nazionale anticorruzione"

  agenzia_entrate:
    - "agenzia delle entrate"
    - "ade"
    - "a.d.e."
    - "a.d.e"

  # Enti territoriali
  regione:
    - "regione"
    - "reg."
    - "reg"

  provincia:
    - "provincia"
    - "prov."
    - "prov"

  comune:
    - "comune"
    - "com."
    - "com"

  citta_metropolitana:
    - "città metropolitana"
    - "c.m."
    - "c.m"
    - "cm"

# ===================================
# SEZIONE 5: PATTERN REGEX ESPANSI
# ===================================
regex_patterns:
  legal_acts:
    # Decreti Legislativi
    - r'\b(?:d\.?\s*lgs\.?|decreto\s+legislativo)\s+n?\.?\s*\d+(?:/\d{4})?'
    - r'\bd\.?\s*lg\.?\s+n?\.?\s*\d+(?:/\d{4})?'
    
    # Decreti del Presidente della Repubblica
    - r'\b(?:d\.?\s*p\.?\s*r\.?|dpr)\s+n?\.?\s*\d+(?:/\d{4})?'
    
    # Decreti Legge
    - r'\b(?:d\.?\s*l\.?|decreto\s+legge)\s+n?\.?\s*\d+(?:/\d{4})?'
    
    # Decreti Ministeriali
    - r'\b(?:d\.?\s*m\.?|decreto\s+ministeriale)\s+n?\.?\s*\d+(?:/\d{4})?'
    
    # Decreti del Presidente del Consiglio
    - r'\b(?:d\.?\s*p\.?\s*c\.?\s*m\.?|dpcm)\s+n?\.?\s*\d+(?:/\d{4})?'
    
    # Decreti Dirigenziali
    - r'\b(?:d\.?\s*d\.?|decreto\s+dirigenziale|determina(?:zione)?)\s+n?\.?\s*\d+(?:/\d{4})?'
    
    # Leggi
    - r'\b(?:l\.?|legge)\s+n?\.?\s*\d+(?:/\d{4})?'
    - r'\b(?:l\.?\s*r\.?|legge\s+regionale)\s+n?\.?\s*\d+(?:/\d{4})?'
    - r'\b(?:l\.?\s*p\.?|legge\s+provinciale)\s+n?\.?\s*\d+(?:/\d{4})?'
    - r'\b(?:l\.?\s*cost\.?|legge\s+costituzionale)\s+n?\.?\s*\d+(?:/\d{4})?'
    
    # Delibere
    - r'\b(?:d\.?\s*g\.?\s*r\.?|delibera\s+giunta\s+regionale)\s+n?\.?\s*\d+(?:/\d{4})?'
    - r'\b(?:d\.?\s*c\.?\s*r\.?|delibera\s+consiglio\s+regionale)\s+n?\.?\s*\d+(?:/\d{4})?'
    - r'\b(?:d\.?\s*g\.?\s*c\.?|delibera\s+giunta\s+comunale)\s+n?\.?\s*\d+(?:/\d{4})?'
    - r'\b(?:d\.?\s*c\.?\s*c\.?|delibera\s+consiglio\s+comunale)\s+n?\.?\s*\d+(?:/\d{4})?'
    
    # Normativa Europea
    - r'\b(?:reg\.?\s*(?:ue|ce)|regolamento\s+(?:ue|ce))\s+n?\.?\s*\d+(?:/\d{4})?'
    - r'\b(?:dir\.?\s*(?:ue|ce|cee)|direttiva\s+(?:ue|ce|cee))\s+\d{4}/\d+(?:/(?:ue|ce|cee))?'
    - r'\b(?:dec\.?\s*(?:ue|ce)|decisione\s+(?:ue|ce))\s+n?\.?\s*\d+(?:/\d{4})?'

  codes:
    # Codici principali
    - r'\bc\.?\s*c\.?(?:\s+|$)'           # c.c. = codice civile
    - r'\bc\.?\s*p\.?\s*c\.?(?:\s+|$)'    # c.p.c. = codice proc. civile
    - r'\bc\.?\s*p\.?\s*p\.?(?:\s+|$)'    # c.p.p. = codice proc. penale
    - r'\bc\.?\s*p\.?(?:\s+|$)(?!\.?c\.?|\.?p\.?)'  # c.p. = codice penale (escludi c.p.c. e c.p.p.)
    
    # Codici speciali
    - r'\bc\.?\s*nav\.?(?:\s+|$)'         # codice navigazione
    - r'\bc\.?\s*str\.?(?:\s+|$)'         # codice strada
    - r'\bc\.?d\.?s\.?(?:\s+|$)'          # c.d.s. = codice della strada
    - r'\bccii(?:\s+|$)'                  # codice crisi impresa
    - r'\bc\.?\s*cons\.?(?:\s+|$)'        # codice consumo
    - r'\bc\.?\s*amb\.?(?:\s+|$)'         # codice ambiente
    
    # Testi Unici
    - r'\bt\.?\s*u\.?(?:\s+|$)'           # testo unico generico
    - r'\btub(?:\s+|$)'                   # testo unico bancario
    - r'\btuf(?:\s+|$)'                   # testo unico finanza
    - r'\btulps(?:\s+|$)'                 # testo unico pubblica sicurezza
    - r'\btuel(?:\s+|$)'                  # testo unico enti locali
    - r'\btuir(?:\s+|$)'                  # testo unico imposte redditi
    - r'\btusl(?:\s+|$)'                  # testo unico sicurezza lavoro

  articles:
    # Articoli e suddivisioni
    - r'\bart\.?\s*\d+(?:\s*[,-]?\s*(?:co\.?|comma)\s*\d+)?'
    - r'\barticolo\s+\d+(?:\s*[,-]?\s*(?:comma)\s*\d+)?'
    - r'\bcomma\s+\d+'
    - r'\blett\.?\s*[a-z]'
    - r'\blettera\s+[a-z]'
    - r'\bn\.?\s*\d+(?:-\w+)?'  # numero con possibile suffisso
    - r'\bparagrafo\s+\d+'
    - r'\bpar\.?\s*\d+'
    - r'\bcapoverso\s+\d+'
    - r'\bcpv\.?\s*\d+'

  institutions:
    # Corti e tribunali
    - r'\b(?:cassazione|cass\.?)\b'
    - r'\b(?:corte\s+costituzionale|corte\s+cost\.?)\b'
    - r'\b(?:consiglio\s+di\s+stato|cons\.?\s*st\.?)\b'
    - r'\b(?:tar|t\.?a\.?r\.?|tribunale\s+amministrativo\s+regionale)\b'
    - r'\b(?:tribunale|trib\.?)\b'
    - r'\b(?:corte\s+d\'appello|app\.?)\b'
    - r'\b(?:pretura|pret\.?|pretore)\b'
    - r'\b(?:giudice\s+di\s+pace|g\.?d\.?p\.?)\b'
    - r'\b(?:procura\s+della\s+repubblica|proc\.?\s*rep\.?)\b'

  european_acts:
    # Atti europei specifici
    - r'\btrattato\s+(?:sull\'unione\s+europea|tue)\b'
    - r'\btrattato\s+(?:sul\s+funzionamento|tfue)\b'
    - r'\bconvenzione\s+europea\s+diritti\s+uomo'
    - r'\bcedu\b'
    - r'\bcarta\s+(?:dei\s+)?diritti\s+fondamentali'

# ===================================
# SEZIONE 6: PATTERN CONTESTUALI ESPANSI
# ===================================
context_patterns:
  normative_references:
    # Riferimenti normativi diretti
    - r'(?:secondo|ai\s+sensi|in\s+base\s+a|previsto|stabilito)\s+(?:da|dal|dall?|nel)'
    - r'(?:disciplina|regola|prevede|stabilisce|dispone)'
    - r'(?:modificato|integrato|sostituito|abrogato)\s+(?:da|dal|con)'
    - r'(?:applicazione|attuazione)\s+(?:del|della|di)'
    - r'(?:conformemente|in\s+conformità)\s+(?:a|al|alla)'
    - r'(?:violazione|inosservanza)\s+(?:del|della|di)'
    - r'(?:deroga|eccezione)\s+(?:a|al|alla)'
    - r'(?:richiamato|citato|menzionato)\s+(?:nel|nella|dall?)'

  legal_procedures:
    # Procedure legali e giudiziarie
    - r'(?:sentenza|decreto|ordinanza)\s+n?\.?\s*\d+'
    - r'(?:tribunale|corte|tar)\s+(?:di\s+)?\w+'
    - r'(?:procedimento|processo|giudizio)\s+(?:n\.?\s*)?\d+'
    - r'(?:ricorso|appello|istanza)\s+(?:n\.?\s*)?\d+'
    - r'(?:parere|decisione|pronuncia)\s+(?:n\.?\s*)?\d+'

  administrative_acts:
    # Atti amministrativi
    - r'(?:delibera|determinazione|provvedimento)\s+(?:n\.?\s*)?\d+'
    - r'(?:circolare|direttiva|istruzione)\s+(?:n\.?\s*)?\d+'
    - r'(?:autorizzazione|concessione|permesso)\s+(?:n\.?\s*)?\d+'
    - r'(?:bando|avviso|comunicazione)\s+(?:n\.?\s*)?\d+'

  enforcement_terms:
    # Termini di applicazione ed enforcement
    - r'(?:entrata\s+in\s+vigore|vigenza|efficacia)'
    - r'(?:pubblicazione|promulgazione)\s+(?:in\s+gazzetta|ufficiale)'
    - r'(?:termine|scadenza|decorso)\s+(?:del|dalla)'
    - r'(?:sanzione|multa|ammenda)\s+(?:di|pari\s+a)'

# ===================================
# SEZIONE 7: ESPANSIONE CONFINI ESTESA
# ===================================
boundary_expansion:
  left_patterns:
    # Tipi di atto completi
    - r'(decreto\s+legislativo\s+n?\.?\s?)$'
    - r'(d\.?\s*lgs\.?\s+n?\.?\s?)$'
    - r'(decreto\s+del\s+presidente\s+della\s+repubblica\s+n?\.?\s?)$'
    - r'(d\.?\s*p\.?\s*r\.?\s+n?\.?\s?)$'
    - r'(decreto\s+legge\s+n?\.?\s?)$'
    - r'(d\.?\s*l\.?\s+n?\.?\s?)$'
    - r'(decreto\s+ministeriale\s+n?\.?\s?)$'
    - r'(d\.?\s*m\.?\s+n?\.?\s?)$'
    - r'(decreto\s+del\s+presidente\s+del\s+consiglio\s+dei\s+ministri\s+n?\.?\s?)$'
    - r'(d\.?\s*p\.?\s*c\.?\s*m\.?\s+n?\.?\s?)$'
    - r'(legge\s+n?\.?\s?)$'
    - r'(l\.?\s+n?\.?\s?)$'
    - r'(legge\s+regionale\s+n?\.?\s?)$'
    - r'(l\.?\s*r\.?\s+n?\.?\s?)$'
    - r'(legge\s+costituzionale\s+n?\.?\s?)$'
    - r'(l\.?\s*cost\.?\s+n?\.?\s?)$'
    - r'(articolo\s+)$'
    - r'(art\.?\s*)$'
    - r'(comma\s+)$'
    - r'(lettera\s+)$'
    - r'(lett\.?\s*)$'
    - r'(paragrafo\s+)$'
    - r'(par\.?\s*)$'
    
    # Codici
    - r'(codice\s+civile\s+art\.?\s*)$'
    - r'(codice\s+penale\s+art\.?\s*)$'
    - r'(codice\s+di\s+procedura\s+civile\s+art\.?\s*)$'
    - r'(codice\s+di\s+procedura\s+penale\s+art\.?\s*)$'
    - r'((?:c\.?\s*c\.?|c\.?\s*p\.?|c\.?\s*p\.?\s*c\.?|c\.?\s*p\.?\s*p\.?)\s+art\.?\s*)$'
    
    # Testi Unici
    - r'(testo\s+unico\s+n?\.?\s?)$'
    - r'(t\.?\s*u\.?\s+n?\.?\s?)$'
    - r'((?:tub|tuf|tulps|tuel|tuir|tusl)\s+art\.?\s*)$'
    
    # Costituzione
    - r'(costituzione\s+art\.?\s*)$'
    - r'(cost\.?\s+art\.?\s*)$'
    
    # Normativa europea
    - r'(regolamento\s+(?:ue|ce)\s+n?\.?\s?)$'
    - r'(reg\.?\s+(?:ue|ce)\s+n?\.?\s?)$'
    - r'(direttiva\s+(?:ue|ce|cee)\s+)$'
    - r'(dir\.?\s+(?:ue|ce|cee)\s+)$'
    - r'(trattato\s+(?:ue|ce)\s+art\.?\s*)$'

  right_patterns:
    # Date e anni
    - r'^(\s+del\s+\d{1,2}[/-]\d{1,2}[/-]\d{4})'    # " del 12/03/2020"
    - r'^(\s+del\s+\d{4})'                           # " del 2001"
    - r'^(/\d{4})'                                   # "/2001"
    - r'^(\s+dell?\s+\d{4})'                         # " del 2001"
    
    # Articoli e suddivisioni
    - r'^(\s*,\s*articolo\s+\d+)'                    # ", articolo 25"
    - r'^(\s*,\s*art\.?\s*\d+)'                      # ", art. 25"
    - r'^(\s*,\s*comma\s+\d+)'                       # ", comma 2"
    - r'^(\s*,\s*co\.?\s*\d+)'                       # ", co. 2"
    - r'^(\s*,\s*lettera\s+[a-z])'                   # ", lettera a"
    - r'^(\s*,\s*lett\.?\s*[a-z])'                   # ", lett. a"
    - r'^(\s*,\s*paragrafo\s+\d+)'                   # ", paragrafo 3"
    - r'^(\s*,\s*par\.?\s*\d+)'                      # ", par. 3"
    
    # Versioni e modifiche
    - r'^(\s+come\s+modificato\s+da)'                # " come modificato da"
    - r'^(\s+e\s+successive\s+modificazioni)'        # " e successive modificazioni"
    - r'^(\s+e\s+s\.?m\.?i\.?)'                      # " e s.m.i."
    - r'^(\s+vigente)'                               # " vigente"
    
    # Allegati e appendici
    - r'^(\s*,\s*allegato\s+[A-Z])'                  # ", allegato A"
    - r'^(\s*,\s*all\.?\s*[A-Z])'                    # ", all. A"
    - r'^(\s*,\s*appendice\s+[A-Z])'                 # ", appendice A"
    - r'^(\s*,\s*app\.?\s*[A-Z])'                    # ", app. A"

# ===================================
# SEZIONE 8: PROTOTIPI SEMANTICI ESPANSI
# ===================================
semantic_prototypes:
  # Decreti
  decreto_legislativo:
    - "decreto legislativo numero del anno"
    - "d.lgs. n. del"
    - "decreto legislativo che disciplina"
    - "decreto legislativo in materia di"
    - "dlgs recante disposizioni"

  decreto_legge:
    - "decreto legge numero del anno" 
    - "d.l. n. del"
    - "decreto legge convertito in legge"
    - "decreto legge recante misure"
    - "decreto legge urgente"

  decreto_presidente_repubblica:
    - "decreto del presidente della repubblica"
    - "d.p.r. n. del"
    - "dpr che approva il regolamento"
    - "decreto presidente repubblica recante"

  decreto_ministeriale:
    - "decreto ministeriale numero del anno"
    - "d.m. n. del"
    - "decreto del ministro"
    - "decreto ministeriale recante"

  decreto_presidente_consiglio:
    - "decreto del presidente del consiglio dei ministri"
    - "d.p.c.m. n. del"
    - "dpcm recante disposizioni"
    - "decreto presidente consiglio ministri"

  # Leggi
  legge:
    - "legge numero del anno"
    - "l. n. del"
    - "legge che stabilisce"
    - "legge recante disposizioni"
    - "legge in materia di"

  legge_fallimentare:
    - "legge fallimentare regio decreto 267 del 1942"
    - "articolo della legge fallimentare"
    - "disciplina fallimentare prevista dalla l.f."
    - "r.d. 267/1942 legge fallimentare"

  legge_costituzionale:
    - "legge costituzionale numero del anno"
    - "l.cost. che modifica la costituzione"
    - "legge costituzionale recante"

  legge_regionale:
    - "legge regionale numero del anno"
    - "l.r. n. del"
    - "legge regionale in materia di"
    - "legge regionale recante"

  # Codici
  codice_civile:
    - "codice civile articolo"
    - "c.c. disposizioni"
    - "secondo il codice civile"
    - "disciplina codicistica civile"

  codice_penale:
    - "codice penale articolo"
    - "c.p. reato previsto"
    - "secondo il codice penale"
    - "fattispecie penale"

  codice_procedura_civile:
    - "codice di procedura civile articolo"
    - "c.p.c. processo civile"
    - "secondo il codice di procedura civile"
    - "disciplina processuale civile"

  codice_procedura_penale:
    - "codice di procedura penale articolo"
    - "c.p.p. processo penale"
    - "secondo il codice di procedura penale"
    - "procedimento penale"

  codice_crisi_impresa:
    - "codice della crisi d'impresa e dell'insolvenza"
    - "ccii articolo"
    - "disciplina della crisi d'impresa"
    - "procedura di insolvenza"

  codice_beni_culturali:
    - "codice dei beni culturali e del paesaggio"
    - "d.lgs. 42 del 2004 beni culturali"
    - "tutela dei beni culturali secondo il codice"
    - "disciplina dei beni culturali"

  codice_navigazione:
    - "codice della navigazione"
    - "c.nav. disciplina marittima"
    - "disciplina della navigazione"

  codice_strada:
    - "codice della strada"
    - "c.d.s. circolazione stradale"
    - "disciplina della circolazione"
    - "norme di circolazione"

  codice_consumo:
    - "codice del consumo"
    - "c.cons. tutela consumatori"
    - "diritti dei consumatori"

  codice_ambiente:
    - "codice dell'ambiente"
    - "c.amb. tutela ambientale"
    - "disciplina ambientale"

  # Testi Unici
  testo_unico:
    - "testo unico numero del anno"
    - "t.u. disposizioni"
    - "secondo il testo unico"

  tub:
    - "testo unico bancario"
    - "tub disciplina bancaria"
    - "attività bancaria e creditizia"
    - "intermediazione bancaria"

  tuf:
    - "testo unico della finanza"
    - "tuf intermediazione finanziaria"
    - "servizi di investimento"
    - "mercati finanziari"

  tulps:
    - "testo unico delle leggi di pubblica sicurezza"
    - "tulps pubblica sicurezza"
    - "ordine pubblico e sicurezza"

  tuel:
    - "testo unico degli enti locali"
    - "tuel amministrazione locale"
    - "ordinamento degli enti locali"

  tuir:
    - "testo unico delle imposte sui redditi"
    - "tuir imposte dirette"
    - "disciplina fiscale dei redditi"

  tusl:
    - "testo unico sulla sicurezza del lavoro"
    - "tusl sicurezza sul lavoro"
    - "disciplina della sicurezza lavorativa"

  # Costituzione
  costituzione:
    - "costituzione italiana articolo"
    - "carta costituzionale"
    - "secondo la costituzione"
    - "principi costituzionali"
    - "disciplina costituzionale"

  # Normativa Europea
  regolamento_ue:
    - "regolamento unione europea numero"
    - "reg. ue che stabilisce"  
    - "secondo il regolamento europeo"
    - "disciplina comunitaria"
    - "normativa europea direttamente applicabile"

  direttiva_ue:
    - "direttiva unione europea numero"
    - "dir. ue che disciplina"
    - "recepimento della direttiva europea"
    - "armonizzazione europea"
    - "disciplina comunitaria da recepire"

  trattato_unione_europea:
    - "trattato sull'unione europea"
    - "tue articolo"
    - "secondo il trattato europeo"
    - "tfue disposizioni"
    - "principi del trattato"

  convenzione_europea_diritti:
    - "convenzione europea diritti dell'uomo"
    - "cedu articolo"
    - "tutela dei diritti fondamentali"
    - "corte europea diritti uomo"

  # Istituzioni
  cassazione:
    - "suprema corte di cassazione"
    - "cass. sezioni unite"
    - "cassazione civile penale"
    - "giurisprudenza di cassazione"

  corte_costituzionale:
    - "corte costituzionale"
    - "consulta sentenza"
    - "controllo di costituzionalità"
    - "giudizio costituzionale"

  consiglio_stato:
    - "consiglio di stato"
    - "cons. st. adunanza plenaria"
    - "giustizia amministrativa"
    - "giurisdizione amministrativa"

  tar:
    - "tribunale amministrativo regionale"
    - "tar ricorso amministrativo"
    - "giustizia amministrativa"

# ===================================
# SEZIONE 9: PATTERN DI PARSING ESPANSI
# ===================================
parsing_patterns:
  # Pattern base
  act_number: r"(?:n\.?|numero)\s*(\d+)"
  date: r"(?:del|in\s+data\s+del)\s*(\d{1,2}[/-]\d{1,2}[/-]\d{4}|\d{4})"
  article: r"(?:art\.?|articolo)\s*(\d+)"
  comma: r"(?:co\.?|comma)\s*(\d+)"
  letter: r"(?:lett\.?|lettera)\s*([a-z])"
  paragraph: r"(?:par\.?|paragrafo)\s*(\d+)"
  
  # Pattern avanzati
  number_bis: r"(?:n\.?\s*\d+)(?:\s*[-]?\s*(bis|ter|quater|quinquies|sexies|septies|octies|novies|decies))?"
  article_bis: r"(?:art\.?\s*\d+)(?:\s*[-]?\s*(bis|ter|quater|quinquies|sexies|septies|octies|novies|decies))?"
  
  # Pattern per allegati
  annex: r"(?:allegato|all\.?)\s*([A-Z]|\d+)"
  appendix: r"(?:appendice|app\.?)\s*([A-Z]|\d+)"
  
  # Pattern per modifiche
  modification: r"(?:come\s+)?(?:modificato|integrato|sostituito)\s+(?:da|dal|con)"
  subsequent_modifications: r"(?:e\s+successive\s+modificazioni|e\s+s\.?m\.?i\.?)"
  
  # Pattern speciali per normativa europea
  eu_directive: r"direttiva\s*\((?:ue|ce|cee)\)\s*(\d{4})/(\d{1,4})"
  eu_regulation: r"regolamento\s*\((?:ue|ce)\)\s*(?:n\.?\s*)?(\d+)/(\d{4})"
  eu_decision: r"decisione\s*\((?:ue|ce)\)\s*(\d{4})/(\d{1,4})"
  
  # Pattern per identificazione atti regionali/locali
  regional_act: r"(?:regione|reg\.?)\s+(\w+)"
  provincial_act: r"(?:provincia|prov\.?)\s+(\w+)"
  municipal_act: r"(?:comune|com\.?)\s+(?:di\s+)?(\w+)"
  
  # Pattern date con priorità estese
  date_patterns:
    primary: r"(?:del|in\s+data\s+del)\s*(\d{1,2}[/-]\d{1,2}[/-]\d{4}|\d{4})"
    secondary: r"\d{1,4}/(\d{4})"
    tertiary: r"(\d{4})$"
    european: r"(\d{4})/(\d{1,4})(?:/(?:ue|ce|cee))?"
    full_date: r"(\d{1,2})\s+(?:gennaio|febbraio|marzo|aprile|maggio|giugno|luglio|agosto|settembre|ottobre|novembre|dicembre)\s+(\d{4})"

# ===================================
# SEZIONE 10: FILTRI ANTI-SPURIO ESPANSI
# ===================================
spurious_filters:
  min_length: 3

  valid_short_terms:
    - "l."
    - "l"
    - "cc"
    - "c.c."
    - "cp"
    - "c.p."  
    - "tu"
    - "tar"
    - "ue"
    - "ce"
    - "id"
    - "es"
    - "vs"
    - "ex"

  spurious_words:
    - "l'"
    - "il"
    - "la"
    - "lo"
    - "le"
    - "gli"
    - "del"
    - "della"
    - "dello"
    - "delle"
    - "degli"
    - "dei"
    - "dal"
    - "dalla"
    - "dallo"
    - "dalle"
    - "dagli"
    - "dai"
    - "nel"
    - "nella"
    - "nello"
    - "nelle"
    - "negli"
    - "nei"
    - "al"
    - "alla"
    - "allo"
    - "alle"
    - "agli"
    - "ai"
    - "sul"
    - "sulla"
    - "sullo"
    - "sulle"
    - "sugli"
    - "sui"
    - "con"
    - "per"
    - "tra"
    - "fra"
    - "si"
    - "s."
    - "n."
    - "di"
    - "da"
    - "in"
    - "su"
    - "a"
    - "e"
    - "o"
    - "ma"
    - "se"
    - "che"
    - "cui"
    - "non"
    - "più"
    - "può"
    - "suo"
    - "sua"
    - "suoi"
    - "sue"

  spurious_patterns:
    - r"^s\.\s*$"
    - r"^s\.\s*n\.\s*$"
    - r"^n\.\s*$"  
    - r"^\d{1,2}$"
    - r"^[a-z]$"
    - r"^[ivxlcdm]+$"  # numeri romani brevi
    - r"^[a-z]{1,2}\)$"  # lettere con parentesi
    - r"^\d{1,2}\)$"     # numeri con parentesi
    - r"^p\.?\s*\d+$"    # pagine
    - r"^pp\.?\s*\d+"    # pagine multiple
    - r"^vol\.?\s*\d+$"  # volumi
    - r"^cap\.?\s*\d+$"  # capitoli
    - r"^sez\.?\s*\d+$"  # sezioni

  filter_single_alpha: true
  min_detection_confidence: 0.6

  # Filtri specifici per contesto
  context_filters:
    - "bibliografia"
    - "indice"
    - "sommario"  
    - "riferimenti"
    - "note"
    - "appendice"
    - "allegato"

# ===================================
# SEZIONE 11: PAROLE CONTESTO LEGALE ESPANSE
# ===================================
legal_context_words:
  - "decreto"
  - "legge"
  - "articolo"
  - "art"
  - "comma"
  - "dlgs"
  - "dpr"
  - "dpcm"
  - "norma"
  - "normativa"
  - "codice"
  - "costituzione"
  - "tribunale"
  - "corte"
  - "sentenza"
  - "ordinanza"
  - "delibera"
  - "determinazione"
  - "regolamento"
  - "direttiva"
  - "circolare"
  - "istruzione"
  - "disposizione" 
  - "disciplina"
  - "disciplinare"
  - "stabilisce"
  - "prevede"
  - "dispone"
  - "sancisce"
  - "vieta"
  - "consente"
  - "autorizza"
  - "obbliga"
  - "prescrive"
  - "modificato"
  - "abrogato"
  - "sostituito"
  - "integrato"
  - "emanato"
  - "promulgato"
  - "pubblicato"
  - "vigente"
  - "applicabile"
  - "procedimento"
  - "procedura"
  - "processo"
  - "giudizio"
  - "ricorso"
  - "appello"
  - "istanza"
  - "domanda"
  - "richiesta"
  - "autorizzazione"
  - "concessione"
  - "permesso"
  - "licenza"
  - "nullità"
  - "annullamento"
  - "revoca"
  - "sospensione"
  - "sanzione"
  - "multa"
  - "ammenda"
  - "violazione"
  - "inosservanza"
  - "inadempimento"
  - "trasgressione"

# ===================================
# SEZIONE 12: CONFIGURAZIONE OUTPUT ESPANSA
# ===================================
output_settings:
  filter_institutions: true
  filter_null_values: true
  enable_debug_logging: false
  log_pattern_matches: false
  max_logged_patterns: 3
  
  # Controlli di qualità output
  quality_checks:
    min_confidence_threshold: 0.6
    max_results_per_document: 100
    deduplicate_similar: true
    similarity_threshold: 0.85
    
  # Formattazione output
  output_format:
    include_source_text: true
    include_confidence_score: true
    include_classification_method: true
    include_context_window: false
    normalize_abbreviations: true
    
  # Metadati aggiuntivi
  metadata:
    include_parsing_timestamp: true
    include_model_version: true
    include_config_hash: true
    
  # Validazione finale
  final_validation:
    check_completeness: true
    validate_references: true
    cross_reference_check: false
